/*
 mark.js: Tiny/Open framework for managing dependencies in JavaScript
 version: 0.2.1
 By Ali Najafizadeh
 MIT Licensed.
*/
(function(){function h(a,b,c){setTimeout(function(){a.apply(c,b)},13)}function p(a){return a instanceof Array?"array":typeof a}function f(a){return"string"==p(a)}function g(a){return"function"==p(a)}function k(a,b){var c=l[a],d;if(c){for(d=0;d<c.length;d++)h(c[d],b);delete l[a]}}function t(a,b,c){l[a]||(l[a]=[]);l[a].push(function(){b.apply(c,arguments)})}function q(a){return r[a]=r[a]?r[a]:{name:a,status:u,argsMap:{}}}function C(a){var b=m[w],c=m[x],d=a.name;if(!g(b))throw"function for event '"+
w+"' is not defined.";a.path=b(d);if(!g(c))throw"function for event '"+x+"' is not defined.";a.protocol=c(d,a.path)}function y(a){var b=a.name,c;a.path||C(a);c=m["protocol:"+a.protocol];if(!g(c))throw"function for protocol '"+a.protocol+"' is not defined.";h(c,[a.path],{done:function(d){a.attach?(a.obj=window[a.attach],a.status=n,k(b,[b])):d&&(a.obj=d,a.status=n,k(b,[b]))},failed:function(a){if(a)throw a;throw"asset '"+b+"' is not loaded.";}})}function z(a){var b=r[a],c;this.counter--;if(!this.attach)for(c=
0;c<this.args.length;c++)if(this.args[c]==a){this.argsMap[a]=this.args[c]=b.obj;break}0==this.counter&&(this.attach?y(this):(this.obj=this.fn.apply(this.argsMap,this.args),this.status=n,k(this.name,[this.name])))}function v(a){var b=q(a);switch(b.status){case n:k(a,[a]);break;case u:if(b.attach&&0!=b.counter)for(a=0;a<b.counter;a++)t(b.args[a],z,b),h(v,[b.args[a]]);else y(b)}}function s(a,b,c){a=q(a);a.args||(a.args=b,a.counter=a.args.length,a.attach=c)}function D(a,b,c){var d=q(a);if(d.status==u)if(d.args=
b,d.counter=d.args.length,d.fn=c,d.counter){d.status=A;for(a=0;a<d.counter;a++)t(d.args[a],z,d),h(v,[d.args[a]])}else d.status=n,d.obj=d.fn.apply(d.argsMap,d.args),k(a,[a]);else if(d.status!=A)throw"Module '"+a+"' is implemented before. duplicate implementation";}function B(a,b,c){switch(arguments.length){case 1:if(f(a))s(a,[],a);else throw e;break;case 2:if(f(a))if(f(b))s(a,[],b);else if("array"==p(b))s(a,b,a);else if(g(b)){if(m[a])throw"callback '"+a+"' has been register before.";m[a]=b}else throw e;
else throw e;break;case 3:if(f(a))if("array"==p(b))if(f(c))s(a,b,c);else if(g(c))D(a,b,c);else throw e;else if(f(b)&&g(c))if("load"==a)t(b,function(){var a=q(b);c.call(null,a.obj)}),h(v,[b]);else throw"internal function is not defined.";else throw e;else throw e;break;default:throw e;}}var r={},l={},m={},u="not_loaded",n="loaded",A="loading",w="mark:path",x="mark:protocol",e="unknown signature for mark function.";B.VERSION="0.2.1";window.mark=B})();
